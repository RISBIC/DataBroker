<?xml version="1.0" encoding="UTF-8"?>

<!--                                                                                                          -->
<!-- Copyright (c) 2013-2014, Arjuna Technologies Limited, Newcastle-upon-Tyne, England. All rights reserved. -->
<!--                                                                                                          -->

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j">
    <ui:composition template="../template.xhtml">
        <ui:define name="title">Data Advert</ui:define>

        <ui:define name="head">
            <link rel="stylesheet" type="text/css" href="dataadvert_style.css"/>
            <script src="http://d3js.org/d3.v3.min.js"></script>

        </ui:define>

        <ui:define name="body">
            <!--<ui:include src="/fragments/header.xhtml">
                <ui:param name="titletext" value="Data Advert"/>
            </ui:include>
            <ui:include src="/fragments/navigation_reload.xhtml">
                <ui:param name="doreloadobject" value="#{advert}"/>
                <ui:param name="doreloadaction" value="doReload"/>
            </ui:include>-->

            <!---
            <h:form styleClass="dataadvert">
                <h:panelGroup styleClass="dataadvert" layout="block">
                    <h:panelGroup styleClass="dataadvert-title" layout="block">
                        <h:outputText styleClass="dataadvert-title" value="Single Data Advert!!!"/>
                    </h:panelGroup>
                    <h:panelGroup styleClass="dataadvert-error" layout="block" rendered="#{not empty dataadvert.errorMessage}">
                        <h:outputText styleClass="dataadvert-error-title" value="Error Message: "/>
                        <h:outputText styleClass="dataadvert-error-message" value="#{dataadvert.errorMessage}"/>
                    </h:panelGroup>
                    <h:dataTable styleClass="dataadvert" headerClass="dataadvert-header" columnClasses="dataadvert-column,dataadvert-column,dataadvert-column,dataadvert-column,dataadvert-column,dataadvert-column" value="#{advert.currentAdvert}" var="_advert" rendered="#{empty advert.errorMessage}">
                        <h:column>
                            <f:facet name="header">
                                <h:outputText styleClass="dataadvert-header" value="Service URL"/>
                            </f:facet>
                            <h:outputText styleClass="dataadvert-value" value="#{_advert.serviceURL}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText styleClass="dataadvert-header" value="Requester Id"/>
                            </f:facet>
                            <h:outputText styleClass="dataadvert-value" value="#{_advert.requesterId}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText styleClass="dataadvert-header" value="Metadata Id"/>
                            </f:facet>
                            <h:outputText styleClass="dataadvert-value" value="#{_advert.metadataId}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText styleClass="dataadvert-header" value="Metadata Path"/>
                            </f:facet>
                            <h:outputText styleClass="dataadvert-value" value="#{_advert.metadataPath}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText styleClass="dataadvert-header" value="Root Node"/>
                            </f:facet>
                            <h:outputText styleClass="dataadvert-value" value="#{_advert.isRootNode}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText styleClass="dataadvert-header" value="Node"/>
                            </f:facet>
                            <h:panelGrid styleClass="dataadvert-node" columnClasses="dataadvert-node-column" columns="2">
                                <h:outputText styleClass="dataadvert-node-label" value="Name:"/>
                                <h:outputText styleClass="dataadvert-node-value" value="#{_advert.node.name}"/>
                                <h:outputText styleClass="dataadvert-node-label" value="Summary:"/>
                                <h:outputText styleClass="dataadvert-node-value" value="#{_advert.node.summary}"/>
                                <h:outputText styleClass="dataadvert-node-label" value="Description:"/>
                                <h:outputText styleClass="dataadvert-node-value" value="#{_advert.node.description}"/>
                                <h:outputText styleClass="dataadvert-node-label" value="# Tags:"/>
                                <h:outputText styleClass="dataadvert-node-value" value="#{_advert.node.tags.size()}"/>
                                <h:outputText styleClass="dataadvert-node-label" value="# Children:"/>
                                <h:outputText styleClass="dataadvert-node-value" value="#{_advert.node.childNodes.size()}"/>
                            </h:panelGrid>
                        </h:column>
                    </h:dataTable>
        </h:panelGroup>
    </h:form>
    -->

            <div id="tree-container"></div>
            <div id="infopanel">
                <div class="panel-inner">

                    <form id="nodeInformation" data-bind="template: { foreach: fields}">

                        <div data-bind="if: formFieldType === 'text'">
                            <div class="form-group" data-bind="with: $data">
                                <label data-bind="attr: { for: id }, text: label"></label>
                                <input type="text" class="form-control" data-bind="attr: { id: id }, value: value"></input>
                            </div>
                        </div>

                        <div data-bind="if: formFieldType === 'textarea'">
                            <div class="form-group" data-bind="with: $data">
                                <label data-bind="attr: { for: id }, text: label"></label>
                                <textarea class="form-control" data-bind="attr: { id: id }, text: value"></textarea>
                            </div>
                        </div>
                    </form>

                    <script type="text/html" id="fields-template-short">
                        //<![CDATA[
                        <div class="form-group" data-bind="with: $data">
                            <label data-bind="attr: { for: id }, text: label"></label>
                            <input type="text" class="form-control" data-bind="attr: { id: id }, value: value">
                        </div>
                                //]]>
                    </script>

                    <script type="text/html" id="fields-template-long">
                        //<![CDATA[
                        <div class="form-group" data-bind="with: $data">
                            <label data-bind="attr: { for: id }, text: label"></label>
                            <textarea class="form-control" data-bind="attr: { id: id }, text: value"></textarea>
                        </div>
                                //]]>
                    </script>

                    <script type="text/html" id="fields-template">
                        //<![CDATA[
                        <div data-bind="template: { name: 'fields-template-long', if: typeof value === 'string' && value.length > 35, data: $data }">
                        </div>

                        <div data-bind="template: { name: 'fields-template-short', if: typeof value !== 'string' || (typeof value === 'string' && value.length < 36), data: $data }">
                        </div>
                        //]]>
                    </script>

                </div>
            </div>

            <script type="text/javascript">
            var treeData = JSON.parse(<h:outputText escape="false" value="#{advert.advertsJSON}"/>);
            </script>

            <script src="tree.js"></script>


        </ui:define>
    </ui:composition>
</html>
